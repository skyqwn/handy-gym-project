"use strict";var fileInput=document.querySelector("input[name=avatar]"),fakeFileInput=document.getElementById("fakeFileInput"),avatarBtn=document.getElementById("fileBtn"),deleteBtn=document.getElementById("deleteBtn"),avatarImg=document.querySelector(".avatarImg"),dataTransfer=new DataTransfer,noUserImgSrc="",paintPreview=function(e){e=URL.createObjectURL(e);avatarImg.src=e},addFile=function(e){dataTransfer.clearData(),dataTransfer.items.add(e),fileInput.files=dataTransfer.files},removeFile=function(){dataTransfer.clearData(),fileInput.files=dataTransfer.files},convertBlobToFile=function(e){return new File([e],e.name||"preview",{type:"images/*"})},compressFile=async function(e){try{var t=await imageCompression(e,{maxSizeMB:1,maxWidthOrHeight:120,initialQuality:1,useWebWorker:!1});return t.name=""+(e.name||"힙합"),convertBlobToFile(t)}catch(e){alert("파일 올리는 도중 오류발생")}},fakeHandleFile=async function(e){var e=e.target.files[0];e&&(e=await compressFile(e),paintPreview(e),addFile(e))},imgSrcToFile=async function(e){var a=document.createElement("canvas");a.height=e.naturalHeight,a.width=e.naturalWidth,a.getContext("2d").drawImage(e,0,0);try{var t=await new Promise(function(t){return a.toBlob(function(e){return t(e)})});return convertBlobToFile(t)}catch(e){alert("서버 오류발생")}},init=function(){var t=document.getElementById("originalImg"),a=document.getElementById("noUserImg");window.addEventListener("load",async function(){avatarBtn.addEventListener("click",function(e){fakeFileInput.click()}),deleteBtn.addEventListener("click",function(e){avatarImg.src=noUserImgSrc,removeFile()}),fakeFileInput.addEventListener("change",fakeHandleFile),t&&(e=await imgSrcToFile(t),addFile(e));var e=await imgSrcToFile(a),e=URL.createObjectURL(e);noUserImgSrc=e})};init();